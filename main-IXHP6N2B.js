import{$ as U,A as _,B as E,D as I,E as M,F as L,G as o,H as n,I as p,J as g,K as v,L as h,M as C,N as r,O as w,R as m,T as N,X as O,Y as V,Z as j,_ as R,aa as B,ca as P,da as q,ea as G,i as W,l as H,m as c,q as u,r as f,v as l,w as b,y as $}from"./chunk-MSEZYSR3.js";var x=class i{constructor(t){this.http=t}apiUrl="https://tecweb-project.duckdns.org";obtenerPeliculaPorId(t){return this.http.get(`${this.apiUrl}/movie/${t}`)}buscarPeliculasPorTitulo(t){return this.http.get(`${this.apiUrl}/search?q=${t}`)}addToWatchlist(t,e,a=!1){let s=this.getHeaders();return this.http.post(`${this.apiUrl}/watchlist?user_id=${t}&movie_id=${e}&watched=${a}`,{},{headers:s})}getHeaders(){let t=localStorage.getItem("token");return new V({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}static \u0275fac=function(e){return new(e||i)(H(j))};static \u0275prov=W({token:i,factory:i.\u0275fac,providedIn:"root"})};var Y=(i,t)=>t.id,ee=(i,t)=>t.name;function te(i,t){if(i&1&&(o(0,"span",8),r(1),n()),i&2){let e=t.$implicit;l(),w(e.name)}}function ie(i,t){if(i&1&&(o(0,"div",5)(1,"strong"),r(2,"G\xE9neros:"),n(),M(3,te,2,1,"span",8,ee),n()),i&2){let e=h().$implicit;l(3),L(e.genres)}}function ne(i,t){i&1&&(o(0,"span",7),r(1,"\xA1Agregado a la watchlist!"),n())}function oe(i,t){if(i&1){let e=g();o(0,"div",4)(1,"h3"),r(2),n(),o(3,"p"),r(4),n(),_(5,ie,5,0,"div",5),o(6,"button",6),v("click",function(){let s=u(e).$implicit,S=h(2);return f(S.addToWatchlist(s.id))}),r(7," Agregar a Watchlist "),n(),_(8,ne,2,0,"span",7),n()}if(i&2){let e=t.$implicit,a=h(2);l(2),w(e.title),l(2),w(e.overview),l(),I(e.genres&&e.genres.length>0?5:-1),l(),E("disabled",a.isAddingToWatchlist),l(2),I(a.additionSuccess[e.id]?8:-1)}}function re(i,t){if(i&1&&(o(0,"h2"),r(1,"Resultados de la b\xFAsqueda:"),n(),M(2,oe,9,5,"div",4,Y)),i&2){let e=h();l(2),L(e.movies)}}function ae(i,t){i&1&&(o(0,"p"),r(1,"No se encontraron pel\xEDculas"),n())}var y=class i{constructor(t){this.peliculasService=t}movies=[];isAddingToWatchlist=!1;additionSuccess={};addToWatchlist(t){this.isAddingToWatchlist=!0;let e=this.getCurrentUserId();this.peliculasService.addToWatchlist(e,t).subscribe({next:()=>{this.additionSuccess[t]=!0,setTimeout(()=>{this.additionSuccess[t]=!1},3e3)},error:a=>{console.error("Error adding to watchlist:",a)},complete:()=>{this.isAddingToWatchlist=!1}})}getCurrentUserId(){return JSON.parse(localStorage.getItem("user")||"{}").id}obtenerPeliculas(){this.peliculasService.obtenerPeliculaPorId(2).subscribe(e=>{this.movies=e,console.log("Pel\xEDculas obtenidas:",this.movies)},e=>{console.error("Error al obtener pel\xEDculas:",e)})}buscarPeliculasPorTitulo(t){if(!t){console.error("El t\xEDtulo de la pel\xEDcula no puede estar vac\xEDo");return}this.peliculasService.buscarPeliculasPorTitulo(t).subscribe(e=>{this.movies=e,console.log("Pel\xEDculas encontradas:",this.movies)},e=>{console.error("Error al buscar pel\xEDculas:",e)})}static \u0275fac=function(e){return new(e||i)(b(x))};static \u0275cmp=c({type:i,selectors:[["app-movie-list"]],standalone:!0,features:[m],decls:9,vars:1,consts:[["titleInput",""],["for","title"],["type","text","id","title","placeholder","Escribe el t\xEDtulo de la pel\xEDcula"],[3,"click"],[1,"movie-card"],[1,"genres"],[1,"watchlist-button",3,"click","disabled"],[1,"success-message"],[1,"genre-tag"]],template:function(e,a){if(e&1){let s=g();o(0,"div")(1,"label",1),r(2,"Buscar por t\xEDtulo:"),n(),p(3,"input",2,0),n(),o(5,"button",3),v("click",function(){u(s);let d=C(4);return f(a.buscarPeliculasPorTitulo(d.value))}),r(6,"Buscar"),n(),_(7,re,4,0)(8,ae,2,0,"p")}e&2&&(l(7),I(a.movies&&a.movies.length>0?7:8))},styles:[".movie-card[_ngcontent-%COMP%]{border:1px solid #ddd;padding:1rem;margin-bottom:1rem;border-radius:4px}.genre-tag[_ngcontent-%COMP%]{background:#e0e0e0;padding:.2rem .5rem;border-radius:4px;margin-right:.5rem}.watchlist-button[_ngcontent-%COMP%]{background:#007bff;color:#fff;border:none;padding:.5rem 1rem;border-radius:4px;cursor:pointer;margin-top:1rem}.watchlist-button[_ngcontent-%COMP%]:disabled{background:#ccc}.success-message[_ngcontent-%COMP%]{color:green;margin-left:1rem}"]})};var T=class i{constructor(t){this.peliculasService=t}agregarAWachlist(t,e,a,s){if(console.log("Formulario enviado"),t.preventDefault(),!e||!a){console.error("El ID del usuario y el ID de la pel\xEDcula son obligatorios.");return}let S=s==="true";this.peliculasService.addToWatchlist(e,a,S).subscribe(d=>{console.log("Pel\xEDcula agregada a la lista de seguimiento:",d),alert("Pel\xEDcula agregada con \xE9xito."),this.limpiarFormulario()},d=>{console.error("Error al agregar a la lista de seguimiento:",d),alert("Ocurri\xF3 un error al agregar la pel\xEDcula.")})}limpiarFormulario(){}static \u0275fac=function(e){return new(e||i)(b(x))};static \u0275cmp=c({type:i,selectors:[["app-add-watchlist"]],standalone:!0,features:[m],decls:27,vars:0,consts:[["userIdInput",""],["movieIdInput",""],["watchedInput",""],["for","userId"],["type","number","id","userId","placeholder","Ingrese el ID del usuario","required",""],["for","movieId"],["type","number","id","movieId","placeholder","Ingrese el ID de la pel\xEDcula","required",""],["for","watched"],["id","watched"],["value","true"],["value","false"],["type","button",3,"click"]],template:function(e,a){if(e&1){let s=g();o(0,"div")(1,"h2"),r(2,"Agregar Pel\xEDcula a la Lista de Seguimiento"),n(),o(3,"form")(4,"div")(5,"label",3),r(6,"ID de Usuario:"),n(),p(7,"input",4,0),n(),o(9,"div")(10,"label",5),r(11,"ID de Pel\xEDcula:"),n(),p(12,"input",6,1),n(),o(14,"div")(15,"label",7),r(16,"\xBFVista?"),n(),o(17,"select",8,2)(19,"option",9),r(20,"S\xED"),n(),o(21,"option",10),r(22,"No"),n()()(),o(23,"button",11),v("click",function(d){u(s);let K=C(8),Q=C(13),X=C(18);return f(a.agregarAWachlist(d,+K.value,+Q.value,X.value))}),r(24,"Agregar"),n()()(),o(25,"p"),r(26,"add-watchlist works!"),n()}}})};var z=[{path:"buscar-peliculas",component:y},{path:"agregar-peliculas",component:T},{path:"register",loadComponent:()=>import("./chunk-KF72W5XI.js").then(i=>i.RegisterComponent)},{path:"login",loadComponent:()=>import("./chunk-QMIBPPT5.js").then(i=>i.LoginComponent)},{path:"*",redirectTo:"login"}];var Z={providers:[N({eventCoalescing:!0}),q(z),R()]};function le(i,t){if(i&1){let e=g();o(0,"button",4),v("click",function(){u(e);let s=h();return f(s.logout())}),r(1,"Logout"),n()}}var k=class i{constructor(t){this.authService=t}isAuthenticated=$(!1);ngOnInit(){this.isAuthenticated.set(this.authService.isAuthenticated())}logout(){this.authService.logout(),this.isAuthenticated.set(!1)}static \u0275fac=function(e){return new(e||i)(b(G))};static \u0275cmp=c({type:i,selectors:[["app-header"]],standalone:!0,features:[m],decls:6,vars:1,consts:[[1,"bg-gray-800","p-4","text-white"],[1,"container","mx-auto","flex","justify-between","items-center"],["routerLink","/",1,"text-xl","font-bold"],["class","text-sm underline",3,"click",4,"ngIf"],[1,"text-sm","underline",3,"click"]],template:function(e,a){e&1&&(o(0,"nav",0)(1,"div",1)(2,"a",2),r(3,"MyApp"),n(),o(4,"div"),_(5,le,2,0,"button",3),n()()()),e&2&&(l(5),E("ngIf",a.isAuthenticated()))},dependencies:[P,O]})};var D=class i{title="frontend";static \u0275fac=function(e){return new(e||i)};static \u0275cmp=c({type:i,selectors:[["app-root"]],standalone:!0,features:[m],decls:13,vars:0,consts:[["routerLink","/buscar-peliculas"],["routerLink","/agregar-peliculas",2,"margin-left","20px"],["routerLink","/register",2,"margin-left","20px"],["routerLink","/login",2,"margin-left","20px"]],template:function(e,a){e&1&&(o(0,"div")(1,"h1"),r(2,"Gesti\xF3n de Pel\xEDculas"),n(),p(3,"app-header"),o(4,"a",0),r(5,"Buscar Pel\xEDculas"),n(),o(6,"a",1),r(7,"Agregar Pel\xEDcula"),n(),o(8,"a",2),r(9,"Registrarse"),n(),o(10,"a",3),r(11,"Login"),n(),p(12,"router-outlet"),n())},dependencies:[B,P,k]})};U(D,Z).catch(i=>console.error(i));
