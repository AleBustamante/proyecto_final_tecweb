import{A as x,B as z,C as R,D as j,E as B,F as J,G as q,H as G,I as Z,J as K,K as Q,L as X,N as L,O as Y,X as ee,Z as te,a as H,b as V,c as u,d as _,e as h,f as A,g as l,h as E,i as W,j as p,k as f,m as d,n as w,o as P,p as o,q as n,r as g,s as S,t as v,u as c,v as D,w as U,x as r,y as C,z as y}from"./chunk-FL5EHOXR.js";var T=class i{constructor(t){this.http=t}apiUrl="https://tecweb-project.duckdns.org";obtenerPeliculaPorId(t){return this.http.get(`${this.apiUrl}/movie/${t}`)}buscarPeliculasPorTitulo(t){return this.http.get(`${this.apiUrl}/search?q=${t}`)}getHeaders(){let t=localStorage.getItem("token");return new G({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}addToWatchlist(t,e,a=!1){let s=this.getHeaders();return this.http.post(`${this.apiUrl}/watchlist?user_id=${t}&movie_id=${e}&watched=${a}`,{},{headers:s})}getWatchlist(t){let e=this.getHeaders();return this.http.get(`${this.apiUrl}/watchlist?user_id=${t}`,{headers:e})}actualizarWatched(t,e,a){let s=this.getHeaders();return this.http.patch(`${this.apiUrl}/watchlist?user_id=${t}&movie_id=${e}&watched=${a}`,null,{headers:s})}deleteElementWatchList(t,e){let a=this.getHeaders();return this.http.delete(`${this.apiUrl}/watchlist?user_id=${t}&movie_id=${e}`,{headers:a})}static \u0275fac=function(e){return new(e||i)(V(Z))};static \u0275prov=H({token:i,factory:i.\u0275fac,providedIn:"root"})};var re=(i,t)=>t.id,ae=(i,t)=>t.name;function le(i,t){if(i&1&&(o(0,"span",8),r(1),n()),i&2){let e=t.$implicit;l(),C(e.name)}}function se(i,t){if(i&1&&(o(0,"div",5)(1,"strong"),r(2,"G\xE9neros:"),n(),w(3,le,2,1,"span",8,ae),n()),i&2){let e=c().$implicit;l(3),P(e.genres)}}function ce(i,t){i&1&&(o(0,"span",7),r(1,"\xA1Agregado a la watchlist!"),n())}function me(i,t){if(i&1){let e=S();o(0,"div",4)(1,"h3"),r(2),n(),o(3,"p"),r(4),n(),p(5,se,5,0,"div",5),o(6,"button",6),v("click",function(){let s=_(e).$implicit,m=c(2);return h(m.addToWatchlist(s.id))}),r(7," Agregar a Watchlist "),n(),p(8,ce,2,0,"span",7),n()}if(i&2){let e=t.$implicit,a=c(2);l(2),C(e.title),l(2),C(e.overview),l(),d(e.genres&&e.genres.length>0?5:-1),l(),f("disabled",a.isAddingToWatchlist),l(2),d(a.additionSuccess[e.id]?8:-1)}}function pe(i,t){if(i&1&&(o(0,"h2"),r(1,"Resultados de la b\xFAsqueda:"),n(),w(2,me,9,5,"div",4,re)),i&2){let e=c();l(2),P(e.movies)}}function de(i,t){i&1&&(o(0,"p"),r(1,"No se encontraron pel\xEDculas"),n())}var I=class i{constructor(t){this.peliculasService=t}movies=[];isAddingToWatchlist=!1;additionSuccess={};addToWatchlist(t){this.isAddingToWatchlist=!0;let e=this.getCurrentUserId();this.peliculasService.addToWatchlist(e,t).subscribe({next:()=>{this.additionSuccess[t]=!0,setTimeout(()=>{this.additionSuccess[t]=!1},3e3)},error:a=>{console.error("Error adding to watchlist:",a)},complete:()=>{this.isAddingToWatchlist=!1}})}getCurrentUserId(){return JSON.parse(localStorage.getItem("user")||"{}").id}obtenerPeliculas(){this.peliculasService.obtenerPeliculaPorId(2).subscribe(e=>{this.movies=e,console.log("Pel\xEDculas obtenidas:",this.movies)},e=>{console.error("Error al obtener pel\xEDculas:",e)})}buscarPeliculasPorTitulo(t){if(!t){console.error("El t\xEDtulo de la pel\xEDcula no puede estar vac\xEDo");return}this.peliculasService.buscarPeliculasPorTitulo(t).subscribe(e=>{this.movies=e,console.log("Pel\xEDculas encontradas:",this.movies)},e=>{console.error("Error al buscar pel\xEDculas:",e)})}static \u0275fac=function(e){return new(e||i)(E(T))};static \u0275cmp=u({type:i,selectors:[["app-movie-list"]],standalone:!0,features:[x],decls:9,vars:1,consts:[["titleInput",""],["for","title"],["type","text","id","title","placeholder","Escribe el t\xEDtulo de la pel\xEDcula"],[3,"click"],[1,"movie-card"],[1,"genres"],[1,"watchlist-button",3,"click","disabled"],[1,"success-message"],[1,"genre-tag"]],template:function(e,a){if(e&1){let s=S();o(0,"div")(1,"label",1),r(2,"Buscar por t\xEDtulo:"),n(),g(3,"input",2,0),n(),o(5,"button",3),v("click",function(){_(s);let b=U(4);return h(a.buscarPeliculasPorTitulo(b.value))}),r(6,"Buscar"),n(),p(7,pe,4,0)(8,de,2,0,"p")}e&2&&(l(7),d(a.movies&&a.movies.length>0?7:8))},styles:[".movie-card[_ngcontent-%COMP%]{border:1px solid #ddd;padding:1rem;margin-bottom:1rem;border-radius:4px}.genre-tag[_ngcontent-%COMP%]{background:#e0e0e0;padding:.2rem .5rem;border-radius:4px;margin-right:.5rem}.watchlist-button[_ngcontent-%COMP%]{background:#007bff;color:#fff;border:none;padding:.5rem 1rem;border-radius:4px;cursor:pointer;margin-top:1rem}.watchlist-button[_ngcontent-%COMP%]:disabled{background:#ccc}.success-message[_ngcontent-%COMP%]{color:green;margin-left:1rem}"]})};var ue=(i,t)=>t.movie_id,_e=(i,t)=>t.id;function he(i,t){if(i&1&&g(0,"img",0),i&2){let e=c().$implicit;f("src","https://image.tmdb.org/t/p/w200"+e.poster_path,A)("alt","P\xF3ster de "+e.title)}}function fe(i,t){i&1&&(o(0,"span"),r(1,"No disponible"),n())}function ge(i,t){if(i&1&&g(0,"img",1),i&2){let e=c().$implicit;f("src","https://image.tmdb.org/t/p/w300"+e.backdrop_path,A)("alt","Backdrop de "+e.title)}}function ve(i,t){i&1&&(o(0,"span"),r(1,"No disponible"),n())}function Ce(i,t){if(i&1&&(o(0,"ul")(1,"li"),r(2),n()()),i&2){let e=t.$implicit;l(2),C(e.name)}}function xe(i,t){if(i&1&&w(0,Ce,3,1,"ul",null,_e),i&2){let e=c().$implicit;P(e.genres)}}function be(i,t){if(i&1){let e=S();o(0,"tr")(1,"td"),p(2,he,1,2,"img",0)(3,fe,2,0,"span"),n(),o(4,"td"),p(5,ge,1,2,"img",1)(6,ve,2,0,"span"),n(),o(7,"td"),r(8),n(),o(9,"td")(10,"div",2)(11,"input",3),v("change",function(){let s=_(e).$implicit,m=c(2);return h(m.actualizarEstadoVisto(s.movie_id,!s.watched))}),n(),o(12,"label",4),r(13),n()()(),o(14,"td"),r(15),n(),o(16,"td"),r(17),z(18,"number"),n(),o(19,"td"),r(20),n(),o(21,"td"),p(22,xe,2,0),n(),o(23,"td")(24,"button",5),v("click",function(){let s=_(e).$implicit,m=c(2);return h(m.eliminarElementoWatchlist(s.movie_id))}),r(25," Eliminar "),n()()()}if(i&2){let e=t.$implicit;l(2),d(e.poster_path?2:3),l(3),d(e.backdrop_path?5:6),l(3),C(e.title),l(3),D("id","watched-",e.movie_id,""),f("checked",e.watched),l(),D("for","watched-",e.movie_id,""),l(),y(" ",e.watched?"Visto":"No visto"," "),l(2),y("",e.runtime," min"),l(2),y("",R(18,13,e.vote_average,"1.1-1"),"/10"),l(3),C(e.release_date),l(2),d(e.genres&&e.genres.length>0?22:-1)}}function Se(i,t){if(i&1&&(o(0,"h2"),r(1,"Resultados de la b\xFAsqueda:"),n(),o(2,"table")(3,"thead")(4,"tr")(5,"th"),r(6,"P\xF3ster"),n(),o(7,"th"),r(8,"Backdrop"),n(),o(9,"th"),r(10,"T\xEDtulo"),n(),o(11,"th"),r(12,"Visto"),n(),o(13,"th"),r(14,"Duraci\xF3n"),n(),o(15,"th"),r(16,"Valoraci\xF3n"),n(),o(17,"th"),r(18,"Fecha de lanzamiento"),n(),o(19,"th"),r(20,"G\xE9neros"),n(),o(21,"th"),r(22,"Acciones"),n()()(),o(23,"tbody"),w(24,be,26,16,"tr",null,ue),n()()),i&2){let e=c();l(24),P(e.watchList)}}function Ee(i,t){i&1&&(o(0,"h2"),r(1,"No se encontraron pel\xEDculas"),n())}var M=class i{constructor(t){this.peliculasService=t}ngOnInit(){this.obtenerWatchList(),console.log("xDDDD obtenidas:",this.watchList)}watchList=[];obtenerWatchList(){let t=localStorage.getItem("user");if(t!=null){let e=JSON.parse(t);this.peliculasService.getWatchlist(e.id).subscribe(a=>{this.watchList=a,console.log("Pel\xEDculas obtenidas:",a)},a=>{console.error("Error al obtener pel\xEDculas:",a)})}}actualizarEstadoVisto(t,e){let a=localStorage.getItem("user");if(a!=null){let s=JSON.parse(a);this.peliculasService.actualizarWatched(s.id,t,e).subscribe({next:m=>{console.log("Estado actualizado correctamente:",m);let b=this.watchList.find(O=>O.movie_id===t);b&&(b.watched=e)},error:m=>{console.error("Error al actualizar el estado:",m);let b=this.watchList.find(O=>O.movie_id===t);b&&(b.watched=!e)}})}}eliminarElementoWatchlist(t){let e=localStorage.getItem("user");if(e!=null){let a=JSON.parse(e);this.peliculasService.deleteElementWatchList(a.id,t).subscribe({next:s=>{console.log("Elemento eliminado correctamente:",s),this.watchList=this.watchList.filter(m=>m.movie_id!==t)},error:s=>{console.error("Error al eliminar el elemento:",s)}})}}static \u0275fac=function(e){return new(e||i)(E(T))};static \u0275cmp=u({type:i,selectors:[["app-peliculas"]],standalone:!0,features:[x],decls:2,vars:1,consts:[[2,"width","100px",3,"src","alt"],[2,"width","200px",3,"src","alt"],[1,"watched-toggle"],["type","checkbox",3,"change","checked","id"],[3,"for"],[3,"click"]],template:function(e,a){e&1&&p(0,Se,26,0)(1,Ee,2,0,"h2"),e&2&&d(a.watchList.length>0?0:1)},dependencies:[q,J,ee],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin:20px 0}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;border:1px solid #ddd;text-align:left}table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;max-width:100%;height:auto}"]})};var ne=[{path:"buscar-peliculas",component:I},{path:"register",loadComponent:()=>import("./chunk-L6JMPLMG.js").then(i=>i.RegisterComponent)},{path:"login",loadComponent:()=>import("./chunk-E3I6Q4XR.js").then(i=>i.LoginComponent)},{path:"*",redirectTo:"login"},{path:"watchList",component:M}];var oe={providers:[j({eventCoalescing:!0}),Y(ne),K()]};function we(i,t){if(i&1){let e=S();o(0,"button",4),v("click",function(){_(e);let s=c();return h(s.logout())}),r(1,"Logout"),n()}}var F=class i{constructor(t){this.authService=t}isAuthenticated=W(!1);ngOnInit(){this.isAuthenticated.set(this.authService.isAuthenticated())}logout(){this.authService.logout(),this.isAuthenticated.set(!1)}static \u0275fac=function(e){return new(e||i)(E(te))};static \u0275cmp=u({type:i,selectors:[["app-header"]],standalone:!0,features:[x],decls:6,vars:1,consts:[[1,"bg-gray-800","p-4","text-white"],[1,"container","mx-auto","flex","justify-between","items-center"],["routerLink","/",1,"text-xl","font-bold"],["class","text-sm underline",3,"click",4,"ngIf"],[1,"text-sm","underline",3,"click"]],template:function(e,a){e&1&&(o(0,"nav",0)(1,"div",1)(2,"a",2),r(3,"MyApp"),n(),o(4,"div"),p(5,we,2,0,"button",3),n()()()),e&2&&(l(5),f("ngIf",a.isAuthenticated()))},dependencies:[L,B]})};var $=class i{title="frontend";static \u0275fac=function(e){return new(e||i)};static \u0275cmp=u({type:i,selectors:[["app-root"]],standalone:!0,features:[x],decls:13,vars:0,consts:[["routerLink","/buscar-peliculas"],["routerLink","/register",2,"margin-left","20px"],["routerLink","/login",2,"margin-left","20px"],["routerLink","/watchList",2,"margin-left","20px"]],template:function(e,a){e&1&&(o(0,"div")(1,"h1"),r(2,"Gesti\xF3n de Pel\xEDculas"),n(),g(3,"app-header"),o(4,"a",0),r(5,"Buscar Pel\xEDculas"),n(),o(6,"a",1),r(7,"Registrarse"),n(),o(8,"a",2),r(9,"Login"),n(),o(10,"a",3),r(11,"Lista de peliculas"),n(),g(12,"router-outlet"),n())},dependencies:[X,L,F]})};Q($,oe).catch(i=>console.error(i));
